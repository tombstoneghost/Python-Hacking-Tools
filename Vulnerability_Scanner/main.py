# Imports
import scanner
import optparse


# Getting arguments from CLI
def get_arguments():
    parser = optparse.OptionParser()
    parser.add_option("-t", "--target", dest="target", help="Specify Target URL to scan")
    parser.add_option("-u", "--username", dest="username", help="Specify Username to login")
    parser.add_option("-p", "--password", dest="password", help="Specify Password to login")

    (options, arguments) = parser.parse_args()

    if not options.target:
        parser.error("[-] Please specify a target URL, use --help for more info.")

    return options


# Target URL
target_url = get_arguments().target
username = get_arguments().username
password = get_arguments().password
links_to_ignore = []

# Calling Vulnerability Scanner
vuln_scanner = scanner.Scanner(target_url, links_to_ignore)

if username and password:
    data_dict = {"username": username, "password": password, "Login": "submit"}
    vuln_scanner.session.post(target_url, data_dict)

# Crawling the target
vuln_scanner.crawl(target_url)

# Starting automated scanning
vuln_scanner.run_scanner()
